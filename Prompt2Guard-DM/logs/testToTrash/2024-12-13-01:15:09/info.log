2024-12-13 01:15:09,532 [trainer.py] => Device: cuda
2024-12-13 01:15:09,532 [trainer.py] => batch_size: 2
2024-12-13 01:15:09,532 [trainer.py] => batch_size_eval: 32
2024-12-13 01:15:09,532 [trainer.py] => epochs: 1
2024-12-13 01:15:09,532 [trainer.py] => warmup_epoch: 1
2024-12-13 01:15:09,532 [trainer.py] => init_lr: 0.01
2024-12-13 01:15:09,532 [trainer.py] => lrate: 0.01
2024-12-13 01:15:09,533 [trainer.py] => label_smoothing: 0.1
2024-12-13 01:15:09,533 [trainer.py] => topk_classes: 5
2024-12-13 01:15:09,533 [trainer.py] => K: 7
2024-12-13 01:15:09,533 [trainer.py] => enable_prev_prompt: False
2024-12-13 01:15:09,533 [trainer.py] => ensembling: [False, False, True, False]
2024-12-13 01:15:09,533 [trainer.py] => precision: fp16
2024-12-13 01:15:09,533 [trainer.py] => dataset: cddb
2024-12-13 01:15:09,533 [trainer.py] => task_name: ['biggan', 'whichfaceisreal', 'san', 'guided-diffusion_class2image_ImageNet', 'stable_diffusion_256']
2024-12-13 01:15:09,533 [trainer.py] => data_path: /home/disi/CDDBdataset/Mix/
2024-12-13 01:15:09,533 [trainer.py] => multiclass: [0, 0, 0, 0, 0, 0]
2024-12-13 01:15:09,533 [trainer.py] => class_order: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
2024-12-13 01:15:09,533 [trainer.py] => memory_size: 0
2024-12-13 01:15:09,533 [trainer.py] => memory_per_class: 0
2024-12-13 01:15:09,533 [trainer.py] => fixed_memory: True
2024-12-13 01:15:09,533 [trainer.py] => shuffle: False
2024-12-13 01:15:09,533 [trainer.py] => init_cls: 2
2024-12-13 01:15:09,533 [trainer.py] => increment: 2
2024-12-13 01:15:09,534 [trainer.py] => embd_dim: 768
2024-12-13 01:15:09,534 [trainer.py] => torch_seed: 2
2024-12-13 01:15:09,534 [trainer.py] => seed: [1993]
2024-12-13 01:15:09,534 [trainer.py] => EPSILON: 1e-08
2024-12-13 01:15:09,534 [trainer.py] => init_milestones: [20, 30, 40]
2024-12-13 01:15:09,534 [trainer.py] => init_lr_decay: 0.1
2024-12-13 01:15:09,534 [trainer.py] => init_weight_decay: 0.0005
2024-12-13 01:15:09,534 [trainer.py] => milestones: [20, 30]
2024-12-13 01:15:09,534 [trainer.py] => lrate_decay: 0.1
2024-12-13 01:15:09,534 [trainer.py] => weight_decay: 0.0002
2024-12-13 01:15:09,534 [trainer.py] => num_workers: 6
2024-12-13 01:15:09,534 [trainer.py] => config: ./configs/cddb_training.json
2024-12-13 01:15:09,534 [trainer.py] => wandb: True
2024-12-13 01:15:09,534 [trainer.py] => run_name: testToTrash
2024-12-13 01:15:09,534 [trainer.py] => device: cuda
2024-12-13 01:15:09,857 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
2024-12-13 01:15:09,859 [slinet.py] => CFG -> INPUTSIZE: (224, 224)
2024-12-13 01:15:09,859 [slinet.py] => CFG -> backbonename: ViT-B/16
2024-12-13 01:15:14,653 [trainer.py] => All params: 149665537
2024-12-13 01:15:14,655 [trainer.py] => Trainable params: 149665537
2024-12-13 01:15:14,655 [prompt2guard.py] => Learning on 0-2
2024-12-13 01:15:15,024 [prompt2guard.py] => Parameters to be updated: {'prompt_learner.0.text_prompt', 'prompt_learner.0.img_prompt'}
2024-12-13 01:17:18,958 [prompt2guard.py] => Task 0, Epoch 1/1 => Loss 0.610, Train_accy 67.88, Test_accy 73.25
2024-12-13 01:17:48,560 [trainer.py] => Performance Task 0 for top1: {'total': 73.25, '00-01': 73.25, 'old': 0, 'new': 73.25}
2024-12-13 01:17:48,560 [trainer.py] => Performance Task 0 for mean: {'total': 73.25, '00-01': 73.25, 'old': 0, 'new': 73.25}
2024-12-13 01:17:48,560 [trainer.py] => Performance Task 0 for mix_top_mean: {'total': 73.25, '00-01': 73.25, 'old': 0, 'new': 73.25}
2024-12-13 01:17:48,616 [trainer.py] => All params: 149665537
2024-12-13 01:17:48,617 [trainer.py] => Trainable params: 8960
2024-12-13 01:17:48,617 [prompt2guard.py] => Learning on 2-4
2024-12-13 01:17:48,684 [prompt2guard.py] => Parameters to be updated: {'prompt_learner.1.img_prompt', 'prompt_learner.1.text_prompt'}
2024-12-13 01:19:36,833 [prompt2guard.py] => Task 1, Epoch 1/1 => Loss 0.741, Train_accy 59.42, Test_accy 70.50
2024-12-13 01:20:35,672 [trainer.py] => Performance Task 1 for top1: {'total': 70.92, '00-01': 73.0, '02-03': 66.75, 'old': 73.0, 'new': 66.75}
2024-12-13 01:20:35,673 [trainer.py] => Performance Task 1 for mean: {'total': 70.67, '00-01': 72.75, '02-03': 66.5, 'old': 72.75, 'new': 66.5}
2024-12-13 01:20:35,673 [trainer.py] => Performance Task 1 for mix_top_mean: {'total': 70.92, '00-01': 73.0, '02-03': 66.75, 'old': 73.0, 'new': 66.75}
2024-12-13 01:20:35,805 [trainer.py] => All params: 149665537
2024-12-13 01:20:35,806 [trainer.py] => Trainable params: 8960
2024-12-13 01:20:35,806 [prompt2guard.py] => Learning on 4-6
2024-12-13 01:20:35,874 [prompt2guard.py] => Parameters to be updated: {'prompt_learner.2.img_prompt', 'prompt_learner.2.text_prompt'}
2024-12-13 01:21:20,359 [prompt2guard.py] => Task 2, Epoch 1/1 => Loss 0.806, Train_accy 44.23, Test_accy 69.53
2024-12-13 01:21:50,753 [trainer.py] => Performance Task 2 for top1: {'total': 69.84, '00-01': 73.38, '02-03': 66.75, '04-05': 52.22, 'old': 71.17, 'new': 52.22}
2024-12-13 01:21:50,753 [trainer.py] => Performance Task 2 for mean: {'total': 69.69, '00-01': 73.12, '02-03': 66.75, '04-05': 52.22, 'old': 71.0, 'new': 52.22}
2024-12-13 01:21:50,753 [trainer.py] => Performance Task 2 for mix_top_mean: {'total': 69.69, '00-01': 73.12, '02-03': 66.75, '04-05': 52.22, 'old': 71.0, 'new': 52.22}
2024-12-13 01:21:50,844 [trainer.py] => All params: 149665537
2024-12-13 01:21:50,845 [trainer.py] => Trainable params: 8960
2024-12-13 01:21:50,845 [prompt2guard.py] => Learning on 6-8
2024-12-13 01:21:50,915 [prompt2guard.py] => Parameters to be updated: {'prompt_learner.3.text_prompt', 'prompt_learner.3.img_prompt'}
2024-12-13 01:22:57,797 [prompt2guard.py] => Task 3, Epoch 1/1 => Loss 0.807, Train_accy 45.25, Test_accy 67.18
