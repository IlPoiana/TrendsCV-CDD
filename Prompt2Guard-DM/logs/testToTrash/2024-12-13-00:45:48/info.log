2024-12-13 00:45:48,115 [trainer.py] => Device: cuda
2024-12-13 00:45:48,115 [trainer.py] => batch_size: 2
2024-12-13 00:45:48,115 [trainer.py] => batch_size_eval: 32
2024-12-13 00:45:48,115 [trainer.py] => epochs: 1
2024-12-13 00:45:48,115 [trainer.py] => warmup_epoch: 1
2024-12-13 00:45:48,115 [trainer.py] => init_lr: 0.01
2024-12-13 00:45:48,115 [trainer.py] => lrate: 0.01
2024-12-13 00:45:48,115 [trainer.py] => label_smoothing: 0.1
2024-12-13 00:45:48,115 [trainer.py] => topk_classes: 5
2024-12-13 00:45:48,117 [trainer.py] => K: 7
2024-12-13 00:45:48,117 [trainer.py] => enable_prev_prompt: False
2024-12-13 00:45:48,117 [trainer.py] => ensembling: [False, False, True, False]
2024-12-13 00:45:48,117 [trainer.py] => precision: fp16
2024-12-13 00:45:48,117 [trainer.py] => dataset: cddb
2024-12-13 00:45:48,117 [trainer.py] => task_name: ['gaugan', 'biggan', 'wild', 'whichfaceisreal', 'san', 'stable_diffusion_256']
2024-12-13 00:45:48,117 [trainer.py] => data_path: /home/disi/CDDBdataset/Mix/
2024-12-13 00:45:48,117 [trainer.py] => multiclass: [0, 0, 0, 0, 0, 0]
2024-12-13 00:45:48,118 [trainer.py] => class_order: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
2024-12-13 00:45:48,118 [trainer.py] => memory_size: 0
2024-12-13 00:45:48,118 [trainer.py] => memory_per_class: 0
2024-12-13 00:45:48,118 [trainer.py] => fixed_memory: True
2024-12-13 00:45:48,118 [trainer.py] => shuffle: False
2024-12-13 00:45:48,118 [trainer.py] => init_cls: 2
2024-12-13 00:45:48,118 [trainer.py] => increment: 2
2024-12-13 00:45:48,118 [trainer.py] => embd_dim: 768
2024-12-13 00:45:48,118 [trainer.py] => torch_seed: 2
2024-12-13 00:45:48,118 [trainer.py] => seed: [1993]
2024-12-13 00:45:48,118 [trainer.py] => EPSILON: 1e-08
2024-12-13 00:45:48,118 [trainer.py] => init_milestones: [20, 30, 40]
2024-12-13 00:45:48,118 [trainer.py] => init_lr_decay: 0.1
2024-12-13 00:45:48,119 [trainer.py] => init_weight_decay: 0.0005
2024-12-13 00:45:48,119 [trainer.py] => milestones: [20, 30]
2024-12-13 00:45:48,119 [trainer.py] => lrate_decay: 0.1
2024-12-13 00:45:48,119 [trainer.py] => weight_decay: 0.0002
2024-12-13 00:45:48,119 [trainer.py] => num_workers: 6
2024-12-13 00:45:48,119 [trainer.py] => config: ./configs/cddb_training.json
2024-12-13 00:45:48,119 [trainer.py] => wandb: True
2024-12-13 00:45:48,119 [trainer.py] => run_name: testToTrash
2024-12-13 00:45:48,119 [trainer.py] => device: cuda
2024-12-13 00:45:48,466 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
2024-12-13 00:45:48,474 [slinet.py] => CFG -> INPUTSIZE: (224, 224)
2024-12-13 00:45:48,474 [slinet.py] => CFG -> backbonename: ViT-B/16
2024-12-13 00:45:53,155 [trainer.py] => All params: 149674497
2024-12-13 00:45:53,156 [trainer.py] => Trainable params: 149674497
2024-12-13 00:45:53,156 [prompt2guard.py] => Learning on 0-2
2024-12-13 00:45:53,519 [prompt2guard.py] => Parameters to be updated: {'prompt_learner.0.img_prompt', 'prompt_learner.0.text_prompt'}
2024-12-13 00:50:53,543 [prompt2guard.py] => Task 0, Epoch 1/1 => Loss 0.551, Train_accy 74.87, Test_accy 82.05
2024-12-13 00:52:05,691 [trainer.py] => Performance Task 0 for top1: {'total': 82.05, '00-01': 82.05, 'old': 0, 'new': 82.05}
2024-12-13 00:52:05,691 [trainer.py] => Performance Task 0 for mean: {'total': 82.05, '00-01': 82.05, 'old': 0, 'new': 82.05}
2024-12-13 00:52:05,692 [trainer.py] => Performance Task 0 for mix_top_mean: {'total': 81.95, '00-01': 81.95, 'old': 0, 'new': 81.95}
2024-12-13 00:52:05,861 [trainer.py] => All params: 149674497
2024-12-13 00:52:05,862 [trainer.py] => Trainable params: 8960
2024-12-13 00:52:05,862 [prompt2guard.py] => Learning on 2-4
2024-12-13 00:52:05,932 [prompt2guard.py] => Parameters to be updated: {'prompt_learner.1.img_prompt', 'prompt_learner.1.text_prompt'}
2024-12-13 00:54:26,898 [prompt2guard.py] => Task 1, Epoch 1/1 => Loss 0.616, Train_accy 67.71, Test_accy 78.93
2024-12-13 00:55:16,442 [trainer.py] => Performance Task 1 for top1: {'total': 79.79, '00-01': 81.9, '02-03': 74.5, 'old': 81.9, 'new': 74.5}
2024-12-13 00:55:16,442 [trainer.py] => Performance Task 1 for mean: {'total': 79.39, '00-01': 81.5, '02-03': 74.12, 'old': 81.5, 'new': 74.12}
2024-12-13 00:55:16,442 [trainer.py] => Performance Task 1 for mix_top_mean: {'total': 79.71, '00-01': 81.75, '02-03': 74.62, 'old': 81.75, 'new': 74.62}
2024-12-13 00:55:16,577 [trainer.py] => All params: 149674497
2024-12-13 00:55:16,578 [trainer.py] => Trainable params: 8960
2024-12-13 00:55:16,578 [prompt2guard.py] => Learning on 4-6
2024-12-13 00:55:16,652 [prompt2guard.py] => Parameters to be updated: {'prompt_learner.2.img_prompt', 'prompt_learner.2.text_prompt'}
2024-12-13 01:00:47,631 [prompt2guard.py] => Task 2, Epoch 1/1 => Loss 0.799, Train_accy 53.46, Test_accy 67.61
2024-12-13 01:02:32,559 [trainer.py] => Performance Task 2 for top1: {'total': 70.31, '00-01': 81.9, '02-03': 74.5, '04-05': 57.44, 'old': 79.79, 'new': 57.44}
2024-12-13 01:02:32,560 [trainer.py] => Performance Task 2 for mean: {'total': 69.92, '00-01': 81.45, '02-03': 73.5, '04-05': 57.34, 'old': 79.18, 'new': 57.34}
2024-12-13 01:02:32,560 [trainer.py] => Performance Task 2 for mix_top_mean: {'total': 70.18, '00-01': 81.7, '02-03': 74.25, '04-05': 57.44, 'old': 79.57, 'new': 57.44}
2024-12-13 01:02:32,683 [trainer.py] => All params: 149674497
2024-12-13 01:02:32,684 [trainer.py] => Trainable params: 8960
2024-12-13 01:02:32,685 [prompt2guard.py] => Learning on 6-8
2024-12-13 01:02:32,755 [prompt2guard.py] => Parameters to be updated: {'prompt_learner.3.img_prompt', 'prompt_learner.3.text_prompt'}
2024-12-13 01:05:01,221 [prompt2guard.py] => Task 3, Epoch 1/1 => Loss 0.736, Train_accy 58.67, Test_accy 67.30
2024-12-13 01:06:21,648 [trainer.py] => Performance Task 3 for top1: {'total': 69.88, '00-01': 81.7, '02-03': 74.12, '04-05': 57.59, '06-07': 65.75, 'old': 70.22, 'new': 65.75}
2024-12-13 01:06:21,648 [trainer.py] => Performance Task 3 for mean: {'total': 69.5, '00-01': 81.15, '02-03': 73.25, '04-05': 57.39, '06-07': 66.25, 'old': 69.77, 'new': 66.25}
2024-12-13 01:06:21,648 [trainer.py] => Performance Task 3 for mix_top_mean: {'total': 69.69, '00-01': 81.35, '02-03': 73.75, '04-05': 57.59, '06-07': 65.75, 'old': 70.02, 'new': 65.75}
2024-12-13 01:06:21,741 [trainer.py] => All params: 149674497
2024-12-13 01:06:21,742 [trainer.py] => Trainable params: 8960
2024-12-13 01:06:21,742 [prompt2guard.py] => Learning on 8-10
2024-12-13 01:06:21,810 [prompt2guard.py] => Parameters to be updated: {'prompt_learner.4.text_prompt', 'prompt_learner.4.img_prompt'}
2024-12-13 01:07:44,333 [prompt2guard.py] => Task 4, Epoch 1/1 => Loss 0.799, Train_accy 45.00, Test_accy 67.59
2024-12-13 01:08:58,649 [trainer.py] => Performance Task 4 for top1: {'total': 69.59, '00-01': 81.6, '02-03': 74.12, '04-05': 57.59, '06-07': 66.25, '08-09': 52.22, 'old': 69.88, 'new': 52.22}
2024-12-13 01:08:58,649 [trainer.py] => Performance Task 4 for mean: {'total': 69.33, '00-01': 81.15, '02-03': 73.5, '04-05': 57.54, '06-07': 66.5, '08-09': 52.22, 'old': 69.62, 'new': 52.22}
2024-12-13 01:08:58,649 [trainer.py] => Performance Task 4 for mix_top_mean: {'total': 69.42, '00-01': 81.2, '02-03': 73.88, '04-05': 57.63, '06-07': 66.5, '08-09': 51.11, 'old': 69.73, 'new': 51.11}
2024-12-13 01:08:58,761 [trainer.py] => All params: 149674497
2024-12-13 01:08:58,762 [trainer.py] => Trainable params: 8960
2024-12-13 01:08:58,762 [prompt2guard.py] => Learning on 10-12
2024-12-13 01:08:58,830 [prompt2guard.py] => Parameters to be updated: {'prompt_learner.5.text_prompt', 'prompt_learner.5.img_prompt'}
2024-12-13 01:10:46,399 [prompt2guard.py] => Task 5, Epoch 1/1 => Loss 0.635, Train_accy 64.88, Test_accy 67.42
