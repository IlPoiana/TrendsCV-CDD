2024-12-13 00:45:53,155 [trainer.py] => All params: 149674497
2024-12-13 00:45:53,156 [trainer.py] => Trainable params: 149674497
2024-12-13 00:45:53,156 [prompt2guard.py] => Learning on 0-2
2024-12-13 00:45:53,519 [prompt2guard.py] => Parameters to be updated: {'prompt_learner.0.img_prompt', 'prompt_learner.0.text_prompt'}
  0%|                                                                                                                                         | 0/1 [00:00<?, ?it/s]

Task 0, Epoch 1/1 => Loss 0.551, Train_accy 74.87, Test_accy 82.05: 100%|████████████████████████████████████████████████████████████| 1/1 [05:00<00:00, 300.02s/it]
2024-12-13 00:52:05,691 [trainer.py] => Performance Task 0 for top1: {'total': 82.05, '00-01': 82.05, 'old': 0, 'new': 82.05}
2024-12-13 00:52:05,691 [trainer.py] => Performance Task 0 for mean: {'total': 82.05, '00-01': 82.05, 'old': 0, 'new': 82.05}
2024-12-13 00:52:05,692 [trainer.py] => Performance Task 0 for mix_top_mean: {'total': 81.95, '00-01': 81.95, 'old': 0, 'new': 81.95}
2024-12-13 00:52:05,861 [trainer.py] => All params: 149674497
2024-12-13 00:52:05,862 [trainer.py] => Trainable params: 8960
2024-12-13 00:52:05,862 [prompt2guard.py] => Learning on 2-4
2024-12-13 00:52:05,932 [prompt2guard.py] => Parameters to be updated: {'prompt_learner.1.img_prompt', 'prompt_learner.1.text_prompt'}
  0%|                                                                                                                                         | 0/1 [00:00<?, ?it/s]

Task 1, Epoch 1/1 => Loss 0.616, Train_accy 67.71, Test_accy 78.93: 100%|████████████████████████████████████████████████████████████| 1/1 [02:20<00:00, 140.96s/it]
2024-12-13 00:55:16,442 [trainer.py] => Performance Task 1 for top1: {'total': 79.79, '00-01': 81.9, '02-03': 74.5, 'old': 81.9, 'new': 74.5}
2024-12-13 00:55:16,442 [trainer.py] => Performance Task 1 for mean: {'total': 79.39, '00-01': 81.5, '02-03': 74.12, 'old': 81.5, 'new': 74.12}
2024-12-13 00:55:16,442 [trainer.py] => Performance Task 1 for mix_top_mean: {'total': 79.71, '00-01': 81.75, '02-03': 74.62, 'old': 81.75, 'new': 74.62}
2024-12-13 00:55:16,577 [trainer.py] => All params: 149674497
2024-12-13 00:55:16,578 [trainer.py] => Trainable params: 8960
2024-12-13 00:55:16,578 [prompt2guard.py] => Learning on 4-6
2024-12-13 00:55:16,652 [prompt2guard.py] => Parameters to be updated: {'prompt_learner.2.img_prompt', 'prompt_learner.2.text_prompt'}
  0%|                                                                                                                                         | 0/1 [00:00<?, ?it/s]

Task 2, Epoch 1/1 => Loss 0.799, Train_accy 53.46, Test_accy 67.61: 100%|████████████████████████████████████████████████████████████| 1/1 [05:30<00:00, 330.98s/it]
2024-12-13 01:02:32,559 [trainer.py] => Performance Task 2 for top1: {'total': 70.31, '00-01': 81.9, '02-03': 74.5, '04-05': 57.44, 'old': 79.79, 'new': 57.44}
2024-12-13 01:02:32,560 [trainer.py] => Performance Task 2 for mean: {'total': 69.92, '00-01': 81.45, '02-03': 73.5, '04-05': 57.34, 'old': 79.18, 'new': 57.34}
2024-12-13 01:02:32,560 [trainer.py] => Performance Task 2 for mix_top_mean: {'total': 70.18, '00-01': 81.7, '02-03': 74.25, '04-05': 57.44, 'old': 79.57, 'new': 57.44}
2024-12-13 01:02:32,683 [trainer.py] => All params: 149674497
2024-12-13 01:02:32,684 [trainer.py] => Trainable params: 8960
2024-12-13 01:02:32,685 [prompt2guard.py] => Learning on 6-8
2024-12-13 01:02:32,755 [prompt2guard.py] => Parameters to be updated: {'prompt_learner.3.img_prompt', 'prompt_learner.3.text_prompt'}
  0%|                                                                                                                                         | 0/1 [00:00<?, ?it/s]

Task 3, Epoch 1/1 => Loss 0.736, Train_accy 58.67, Test_accy 67.30: 100%|████████████████████████████████████████████████████████████| 1/1 [02:28<00:00, 148.46s/it]
2024-12-13 01:06:21,648 [trainer.py] => Performance Task 3 for top1: {'total': 69.88, '00-01': 81.7, '02-03': 74.12, '04-05': 57.59, '06-07': 65.75, 'old': 70.22, 'new': 65.75}
2024-12-13 01:06:21,648 [trainer.py] => Performance Task 3 for mean: {'total': 69.5, '00-01': 81.15, '02-03': 73.25, '04-05': 57.39, '06-07': 66.25, 'old': 69.77, 'new': 66.25}
2024-12-13 01:06:21,648 [trainer.py] => Performance Task 3 for mix_top_mean: {'total': 69.69, '00-01': 81.35, '02-03': 73.75, '04-05': 57.59, '06-07': 65.75, 'old': 70.02, 'new': 65.75}
2024-12-13 01:06:21,741 [trainer.py] => All params: 149674497
2024-12-13 01:06:21,742 [trainer.py] => Trainable params: 8960
2024-12-13 01:06:21,742 [prompt2guard.py] => Learning on 8-10
2024-12-13 01:06:21,810 [prompt2guard.py] => Parameters to be updated: {'prompt_learner.4.text_prompt', 'prompt_learner.4.img_prompt'}

Task 4, Epoch 1/1 => Loss 0.799, Train_accy 45.00, Test_accy 67.59: 100%|█████████████████████████████████████████████████████████████| 1/1 [01:22<00:00, 82.52s/it]
2024-12-13 01:07:44,333 [prompt2guard.py] => Task 4, Epoch 1/1 => Loss 0.799, Train_accy 45.00, Test_accy 67.59
2024-12-13 01:08:58,649 [trainer.py] => Performance Task 4 for top1: {'total': 69.59, '00-01': 81.6, '02-03': 74.12, '04-05': 57.59, '06-07': 66.25, '08-09': 52.22, 'old': 69.88, 'new': 52.22}
2024-12-13 01:08:58,649 [trainer.py] => Performance Task 4 for mean: {'total': 69.33, '00-01': 81.15, '02-03': 73.5, '04-05': 57.54, '06-07': 66.5, '08-09': 52.22, 'old': 69.62, 'new': 52.22}
2024-12-13 01:08:58,649 [trainer.py] => Performance Task 4 for mix_top_mean: {'total': 69.42, '00-01': 81.2, '02-03': 73.88, '04-05': 57.63, '06-07': 66.5, '08-09': 51.11, 'old': 69.73, 'new': 51.11}
2024-12-13 01:08:58,761 [trainer.py] => All params: 149674497
2024-12-13 01:08:58,762 [trainer.py] => Trainable params: 8960
2024-12-13 01:08:58,762 [prompt2guard.py] => Learning on 10-12
2024-12-13 01:08:58,830 [prompt2guard.py] => Parameters to be updated: {'prompt_learner.5.text_prompt', 'prompt_learner.5.img_prompt'}
  0%|                                                                                                                                         | 0/1 [00:00<?, ?it/s]

Task 5, Epoch 1/1 => Loss 0.635, Train_accy 64.88, Test_accy 67.42: 100%|████████████████████████████████████████████████████████████| 1/1 [01:47<00:00, 107.57s/it]
Traceback (most recent call last):
  File "/home/disi/Prompt2Guard/src/train.py", line 91, in <module>
    main()
  File "/home/disi/Prompt2Guard/src/train.py", line 12, in main
    train(param)
  File "/home/disi/Prompt2Guard/src/trainer.py", line 55, in train
    model.incremental_train(data_manager)
  File "/home/disi/Prompt2Guard/src/methods/prompt2guard.py", line 127, in incremental_train
    self.clustering(self.train_loader)
  File "/home/disi/Prompt2Guard/src/methods/prompt2guard.py", line 252, in clustering
    self.real_keys_one_vector.append(run_kmeans(self.n_cluster_one, real_fts))
  File "/home/disi/Prompt2Guard/src/methods/prompt2guard.py", line 229, in run_kmeans
    clustering = KMeans(
  File "/home/disi/trendsenv/lib/python3.9/site-packages/sklearn/base.py", line 1152, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "/home/disi/trendsenv/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1475, in fit
    X = self._validate_data(
  File "/home/disi/trendsenv/lib/python3.9/site-packages/sklearn/base.py", line 605, in _validate_data
    out = check_array(X, input_name="X", **check_params)
  File "/home/disi/trendsenv/lib/python3.9/site-packages/sklearn/utils/validation.py", line 967, in check_array
    raise ValueError(
ValueError: Found array with 0 sample(s) (shape=(0, 512)) while a minimum of 1 is required by KMeans.