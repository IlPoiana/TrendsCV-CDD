2024-12-13 01:31:15,687 [trainer.py] => All params: 149638657
2024-12-13 01:31:15,687 [trainer.py] => Trainable params: 149638657
2024-12-13 01:31:15,688 [prompt2guard.py] => Learning on 0-2
2024-12-13 01:31:16,062 [prompt2guard.py] => Parameters to be updated: {'prompt_learner.0.img_prompt', 'prompt_learner.0.text_prompt'}
  0%|                                                                                                                                         | 0/1 [00:00<?, ?it/s]

Task 0, Epoch 1/1 => Loss 0.633, Train_accy 67.88, Test_accy 78.50: 100%|█████████████████████████████████████████████████████████████| 1/1 [00:40<00:00, 40.20s/it]
Traceback (most recent call last):
  File "/home/disi/Prompt2Guard/src/train.py", line 91, in <module>
    main()
  File "/home/disi/Prompt2Guard/src/train.py", line 12, in main
    train(param)
  File "/home/disi/Prompt2Guard/src/trainer.py", line 55, in train
    model.incremental_train(data_manager)
  File "/home/disi/Prompt2Guard/src/methods/prompt2guard.py", line 127, in incremental_train
    self.clustering(self.train_loader)
  File "/home/disi/Prompt2Guard/src/methods/prompt2guard.py", line 252, in clustering
    self.real_keys_one_vector.append(run_kmeans(self.n_cluster_one, real_fts))
  File "/home/disi/Prompt2Guard/src/methods/prompt2guard.py", line 229, in run_kmeans
    clustering = KMeans(
  File "/home/disi/trendsenv/lib/python3.9/site-packages/sklearn/base.py", line 1152, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "/home/disi/trendsenv/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py", line 1475, in fit
    X = self._validate_data(
  File "/home/disi/trendsenv/lib/python3.9/site-packages/sklearn/base.py", line 605, in _validate_data
    out = check_array(X, input_name="X", **check_params)
  File "/home/disi/trendsenv/lib/python3.9/site-packages/sklearn/utils/validation.py", line 967, in check_array
    raise ValueError(
ValueError: Found array with 0 sample(s) (shape=(0, 512)) while a minimum of 1 is required by KMeans.